@using CosmenticFormulaApp.Application.DTOs.Output

<div class="analysis-summary mb-4">
    <div class="row g-3">
        <div class="col-md-3">
            <div class="card border-primary h-100">
                <div class="card-body text-center">
                    <span class="oi oi-beaker display-4 text-primary"></span>
                    <h4 class="mt-2">@TotalSubstances</h4>
                    <p class="card-text text-muted">Total Substances</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card border-success h-100">
                <div class="card-body text-center">
                    <span class="oi oi-star display-4 text-success"></span>
                    <h4 class="mt-2">@MostUsedSubstance?.Name</h4>
                    <p class="card-text text-muted">Most Used Substance</p>
                    <small class="text-success">@(MostUsedSubstance?.TotalWeight.ToString("F2")) g</small>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card border-info h-100">
                <div class="card-body text-center">
                    <span class="oi oi-calculator display-4 text-info"></span>
                    <h4 class="mt-2">@TotalWeight.ToString("F2") g</h4>
                    <p class="card-text text-muted">Total Weight</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card border-warning h-100">
                <div class="card-body text-center">
                    <span class="oi oi-bar-chart display-4 text-warning"></span>
                    <h4 class="mt-2">@AverageWeight.ToString("F2") g</h4>
                    <p class="card-text text-muted">Average per Substance</p>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public List<SubstanceAnalysisDto> Data { get; set; } = new();

    private int TotalSubstances => Data?.Count ?? 0;
    private SubstanceAnalysisDto? MostUsedSubstance => Data?.OrderByDescending(d => d.TotalWeight).FirstOrDefault();
    private decimal TotalWeight => Data?.Sum(d => d.TotalWeight) ?? 0;
    private decimal AverageWeight => TotalSubstances > 0 ? TotalWeight / TotalSubstances : 0;
}